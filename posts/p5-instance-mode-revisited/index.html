<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="Another Instance Mode Test">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>P5 Instance Mode Revisited | p5.js (processing) Explorations</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/ipython.min.css" rel="stylesheet" type="text/css">
<link href="../../assets/css/nikola_ipython.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../../rss.xml">
<link rel="canonical" href="https://necromuralist.github.io/p5_explorations/posts/p5-instance-mode-revisited/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.8/p5.min.js">
</script><meta name="author" content="The Cloistered Monkey">
<link rel="prev" href="../testing-the-re-post/" title="Testing The Re-Post" type="text/html">
<link rel="next" href="../bibliography/" title="Bibliography" type="text/html">
<meta property="og:site_name" content="p5.js (processing) Explorations">
<meta property="og:title" content="P5 Instance Mode Revisited">
<meta property="og:url" content="https://necromuralist.github.io/p5_explorations/posts/p5-instance-mode-revisited/">
<meta property="og:description" content="Another Instance Mode Test">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2018-03-25T13:58:25-07:00">
<meta property="article:tag" content="processing p5 nikola">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-default navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="https://necromuralist.github.io/p5_explorations/">

                <span id="blog-title">p5.js (processing) Explorations</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="../../archive.html">Archive</a>
                </li>
<li>
<a href="../../categories/">Tags</a>
                </li>
<li>
<a href="../../rss.xml">RSS feed</a>
            </li>
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Projects <b class="caret"></b></a>
            <ul class="dropdown-menu">
<li>
<a href="../../machine-learning-projects/">Machine Learning</a>
                    </li>
<li>
<a href="https://necromuralist.github.io/p5_explorations/">P5 Explorations</a>
                    </li>
<li>
<a href="https://necromuralist.github.io/tddmachinelearning/">TDD Machine Learning</a>
                    </li>
<li>
<a href="https://necromuralist.github.io/student_intervention/">Student Intervention Project</a>
                    </li>
<li>
<a href="https://necromuralist.github.io/boston_housing/">Boston Housing Project</a>
            </li>
</ul>
</li>
</ul>
<!-- Google custom search --><form method="get" action="https://www.google.com/search" class="navbar-form navbar-right" role="search">
<div class="form-group">
<input type="text" name="q" class="form-control" placeholder="Search">
</div>
<button type="submit" class="btn btn-primary">
	<span class="glyphicon glyphicon-search"></span>
</button>
<input type="hidden" name="sitesearch" value="https://necromuralist.github.io/p5_explorations/">
</form>
<!-- End of custom search -->


            <ul class="nav navbar-nav navbar-right">
<li>
    <a href="index.rst" id="sourcelink">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">P5 Instance Mode Revisited</a></h1>

        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn" itemprop="author">
                    The Cloistered Monkey
            </span></p>
            <p class="dateline"><a href="." rel="bookmark"><time class="published dt-published" datetime="2018-03-25T13:58:25-07:00" itemprop="datePublished" title="2018-03-25 13:58">2018-03-25 13:58</time></a></p>
            
        <p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <div>
<p>This is a re-do of another <a class="reference external" href="https://necromuralist.github.io/p5_explorations/posts/testing-with-rst/">re-do</a> I did where I tried to remember how to get P5 working again. This is a class-based version that doesn't set everything up in the constructor the way I did it previously. This adds more lines, but it seems better organized to me.</p>
<div class="section" id="the-code">
<h2>The Code</h2>
<p><a class="reference external" href="../../listings/class_based_instance_mode.js.html">class_based_instance_mode.js</a>  <a class="reference external" href="../../listings/class_based_instance_mode.js">(Source)</a></p>
<pre class="code javascript"><a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-1"></a><span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-2"></a><span class="cm"> * Class-based instance mode setup</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-3"></a><span class="cm"> * This uses properties instead of building everything in the constructor</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-4"></a><span class="cm"> */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-5"></a><span class="kr">class</span> <span class="nx">Sketch</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-6"></a>  <span class="cm">/** Constructor to setup the p5 calls</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-7"></a><span class="cm">   * @param {p5} p: the P5 object</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-8"></a><span class="cm">   * @param {object} setup_arguments: setup settings</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-9"></a><span class="cm">   * @param {object} colors: color settings</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-10"></a><span class="cm">   * @param {object} inverted: inverted color settings</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-11"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-12"></a>  <span class="nx">constructor</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span> <span class="nx">setup_arguments</span><span class="p">,</span> <span class="nx">colors</span><span class="p">,</span> <span class="nx">inverted</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-13"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_reset</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-14"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-15"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">setup_arguments</span> <span class="o">=</span> <span class="nx">setup_arguments</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-16"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">colors</span> <span class="o">=</span> <span class="nx">colors</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-17"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">inverted</span> <span class="o">=</span> <span class="nx">inverted</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-18"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">p</span> <span class="o">=</span> <span class="nx">p</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-19"></a>  <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-20"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-21"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-22"></a><span class="cm">   * creates the closure to create the p5 canvas</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-23"></a><span class="cm">   * This is so we have access to our 'this'</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-24"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-25"></a>  <span class="nx">get</span> <span class="nx">setup</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-26"></a>    <span class="kd">let</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-27"></a>    <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-28"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">createCanvas</span><span class="p">(</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-29"></a>        <span class="nx">$</span><span class="p">(</span><span class="s2">"#"</span> <span class="o">+</span> <span class="nx">self</span><span class="p">.</span><span class="nx">setup_arguments</span><span class="p">.</span><span class="nx">parent_id</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">(</span><span class="kc">true</span><span class="p">),</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-30"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">setup_arguments</span><span class="p">.</span><span class="nx">height</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-31"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">strokeWeight</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">setup_arguments</span><span class="p">.</span><span class="nx">stroke_weight</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-32"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-33"></a>    <span class="p">};</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-34"></a>  <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-35"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-36"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-37"></a><span class="cm">   * creates the closure to handle a mouse press</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-38"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-39"></a>  <span class="nx">get</span> <span class="nx">mouse_pressed</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-40"></a>    <span class="kd">let</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-41"></a>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-42"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">inverted</span><span class="p">.</span><span class="nx">background</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-43"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">inverted</span><span class="p">.</span><span class="nx">fill</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-44"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">stroke</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">inverted</span><span class="p">.</span><span class="nx">stroke</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-45"></a>    <span class="p">};</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-46"></a>  <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-47"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-48"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-49"></a><span class="cm">   * closure to handle a mouse release</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-50"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-51"></a>  <span class="nx">get</span> <span class="nx">mouse_released</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-52"></a>    <span class="kd">let</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-53"></a>    <span class="k">return</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-54"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-55"></a>    <span class="p">};</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-56"></a>  <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-57"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-58"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-59"></a><span class="cm">   * creates the closure for the default setup</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-60"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-61"></a>  <span class="nx">get</span> <span class="nx">reset</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-62"></a>    <span class="kd">let</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-63"></a>    <span class="k">if</span> <span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">_reset</span> <span class="o">===</span> <span class="kc">null</span><span class="p">){</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-64"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">_reset</span> <span class="o">=</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-65"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">background</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">colors</span><span class="p">.</span><span class="nx">background</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-66"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">fill</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">colors</span><span class="p">.</span><span class="nx">fill</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-67"></a>        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">stroke</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">colors</span><span class="p">.</span><span class="nx">stroke</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-68"></a>      <span class="p">};</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-69"></a>    <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-70"></a>    <span class="k">return</span> <span class="nx">self</span><span class="p">.</span><span class="nx">_reset</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-71"></a>  <span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-72"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-73"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-74"></a><span class="cm">   * creates closure to draw circles that change diameter</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-75"></a><span class="cm">   * based on mouse speed</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-76"></a><span class="cm">   **/</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-77"></a>  <span class="nx">get</span> <span class="nx">draw</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-78"></a>    <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-79"></a>    <span class="k">return</span> <span class="kd">function</span><span class="p">(){</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-80"></a>      <span class="kd">var</span> <span class="nx">diameter</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-81"></a>      <span class="cm">/* get the distance from last click, raise to 1.5 */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-82"></a>      <span class="nx">diameter</span> <span class="o">=</span> <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">pow</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">dist</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">pmouseX</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-83"></a>                                        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">pmouseY</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-84"></a>                                        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseX</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-85"></a>                                        <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseY</span><span class="p">),</span> <span class="mf">1.5</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-86"></a>      <span class="cm">/* move the ellipse using the new diameter */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-87"></a>      <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">ellipse</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseX</span><span class="p">,</span> <span class="nx">self</span><span class="p">.</span><span class="nx">p</span><span class="p">.</span><span class="nx">mouseY</span><span class="p">,</span> <span class="nx">diameter</span><span class="p">,</span> <span class="nx">diameter</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-88"></a>    <span class="p">};</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-89"></a>  <span class="p">}</span> <span class="c1">// end draw</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-90"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-91"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-92"></a><span class="cm">   * the P5 object with our methods</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-93"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-94"></a>  <span class="nx">get</span> <span class="nx">p</span><span class="p">()</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-95"></a>    <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_p</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-96"></a>  <span class="p">}</span> <span class="c1">// end get p</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-97"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-98"></a>  <span class="cm">/**</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-99"></a><span class="cm">   * sets up the P5 object with our methods</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-100"></a><span class="cm">   * @param {P5} original: the P5 object</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-101"></a><span class="cm">   */</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-102"></a>  <span class="nx">set</span> <span class="nx">p</span><span class="p">(</span><span class="nx">original</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-103"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span> <span class="o">=</span> <span class="nx">original</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-104"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span><span class="p">.</span><span class="nx">draw</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">draw</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-105"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span><span class="p">.</span><span class="nx">setup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">setup</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-106"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span><span class="p">.</span><span class="nx">mousePressed</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse_pressed</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-107"></a>    <span class="k">this</span><span class="p">.</span><span class="nx">_p</span><span class="p">.</span><span class="nx">mouseReleased</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">mouse_released</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-108"></a>  <span class="p">}</span> <span class="c1">// end set p</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-109"></a><span class="p">}</span> <span class="c1">// end Sketch</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-110"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-111"></a><span class="cm">/** Settings objects **/</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-112"></a><span class="kd">let</span> <span class="nx">COLOR</span> <span class="o">=</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">];</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-113"></a><span class="kd">let</span> <span class="nx">WHITE</span> <span class="o">=</span> <span class="mi">255</span><span class="p">;</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-114"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-115"></a><span class="kd">let</span> <span class="nx">setup_arguments</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-116"></a>  <span class="nx">stroke_weight</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-117"></a>  <span class="nx">height</span><span class="o">:</span> <span class="mi">200</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-118"></a>  <span class="nx">parent_id</span><span class="o">:</span> <span class="s2">"class-based-instance-mode"</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-119"></a><span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-120"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-121"></a><span class="kd">let</span> <span class="nx">inverted_colors</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-122"></a>  <span class="nx">background</span><span class="o">:</span> <span class="nx">COLOR</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-123"></a>  <span class="nx">fill</span><span class="o">:</span> <span class="nx">COLOR</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-124"></a>  <span class="nx">stroke</span><span class="o">:</span> <span class="nx">WHITE</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-125"></a>  <span class="nx">height</span><span class="o">:</span> <span class="mi">50</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-126"></a><span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-127"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-128"></a><span class="kd">let</span> <span class="nx">default_colors</span> <span class="o">=</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-129"></a>  <span class="nx">background</span><span class="o">:</span> <span class="nx">WHITE</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-130"></a>  <span class="nx">fill</span><span class="o">:</span> <span class="nx">WHITE</span><span class="p">,</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-131"></a>  <span class="nx">stroke</span><span class="o">:</span> <span class="nx">COLOR</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-132"></a><span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-133"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-134"></a><span class="cm">/** Build the code **/</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-135"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-136"></a><span class="kd">function</span> <span class="nx">builder</span><span class="p">(</span><span class="nx">p</span><span class="p">)</span> <span class="p">{</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-137"></a>  <span class="nx">sketch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Sketch</span><span class="p">(</span><span class="nx">p</span><span class="p">,</span> <span class="nx">setup_arguments</span><span class="p">,</span> <span class="nx">default_colors</span><span class="p">,</span> <span class="nx">inverted_colors</span><span class="p">);</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-138"></a><span class="p">}</span>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-139"></a>
<a name="rest_code_2aeae7a4ea7842a3acc908f198e1e6f5-140"></a><span class="kd">var</span> <span class="nx">sketch</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">p5</span><span class="p">(</span><span class="nx">builder</span><span class="p">,</span> <span class="nx">setup_arguments</span><span class="p">.</span><span class="nx">parent_id</span><span class="p">);</span>
</pre>
</div>
<div class="section" id="the-sketch">
<h2>The Sketch</h2>
<p>For completeness, here is the html to include the sketch and the output of the sketch.</p>
<pre class="code html"><a name="rest_code_ea3904edd81a418f9b72f131a89a4472-1"></a><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">"class-based-instance-mode"</span><span class="p">&gt;</span>
<a name="rest_code_ea3904edd81a418f9b72f131a89a4472-2"></a>    <span class="p">&lt;</span><span class="nt">script</span> <span class="na">language</span><span class="o">=</span><span class="s">"javascript"</span> <span class="na">type</span><span class="o">=</span><span class="s">"text/javascript"</span> <span class="na">src</span><span class="o">=</span><span class="s">'class_based_instance_mode.js'</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
<a name="rest_code_ea3904edd81a418f9b72f131a89a4472-3"></a><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre>
<div id="class-based-instance-mode">
   <script language="javascript" type="text/javascript" src="class_based_instance_mode.js"></script>
</div>
</div>
<div class="section" id="the-closures">
<h2>The Closures</h2>
<p>Although I like the way the code looks when things are set up (more or less) outside of the constructor, it created the problem that the object doesn't have access to the right <tt class="docutils literal">this</tt> when P5 calls the methods I created. To get around this I used the <tt class="docutils literal">get</tt> methods to create closures that bind the right context to the implemented <cite>p5</cite> methods.</p>
<p>In addition, since the <tt class="docutils literal">setup</tt> and <tt class="docutils literal">mouse_released</tt> both set the same colors I created a <tt class="docutils literal">reset</tt> function/property that stores the creation of the function when it's first created. I didn't bother to store <tt class="docutils literal">mouse_pressed</tt> because the getter only gets used once (in the constructor), after that it gets assigned to the <tt class="docutils literal">p5</tt> object anyway.</p>
<p>Putting the <tt class="docutils literal">p</tt> attribute in a setter allowed me to set it up outside of the constructor, but makes it more fragile, as you have to make sure that it gets set after the other attributes or it will be an error.</p>
</div>
<div class="section" id="a-new-problem">
<h2>A New Problem</h2>
<p>I just noticed that the Mouse Presses trigger the inverting of colors for all the boxes on the page. Not a big deal in this case, I guess, although that might be something to work on later.</p>
</div>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/processing-p5-nikola/" rel="tag">processing p5 nikola</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../testing-the-re-post/" rel="prev" title="Testing The Re-Post">Previous post</a>
            </li>
            <li class="next">
                <a href="../bibliography/" rel="next" title="Bibliography">Next post</a>
            </li>
        </ul></nav></aside></article>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents © 2018         <a href="mailto:necromuralist@gmail.com/p5_explorations">The Cloistered Monkey</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         <a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/88x31.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
            
        </footer>
</div>
</div>


            <script src="../../assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("en");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
